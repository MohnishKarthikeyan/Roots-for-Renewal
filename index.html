<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Information</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        /* ... CSS styles ... */
    </style>
</head>

<body>
    <!-- ... Existing HTML code ... -->

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var plantForm = document.getElementById("plantForm");
            var historyData = [];
            var plantCount = 0;

            var plantData = JSON.parse('{{ plantData | safe }}');

            var typeSelect = document.getElementById("type");
            var varietySelect = document.getElementById("variety");
            var placeSelect = document.getElementById("place");
            var plantContainer = document.getElementById("plantContainer");

            // ... Existing JavaScript code ...

            plantForm.addEventListener("submit", function (event) {
                event.preventDefault();

                var selectedType = typeSelect.options[typeSelect.selectedIndex].text;
                var selectedVariety = varietySelect.options[varietySelect.selectedIndex].text;
                var selectedPlace = placeSelect.options[placeSelect.selectedIndex].text;
                var selectedPlant = document.getElementById("selectedPlant").textContent;

                if (!selectedType || !selectedVariety || !selectedPlace || !selectedPlant) {
                    alert("Please select all options before submitting.");
                    return;
                }

                // ... Existing code ...

                var historyEntry = {
                    type: selectedType,
                    variety: selectedVariety,
                    place: selectedPlace,
                    plant: selectedPlant
                };

                historyData.push(historyEntry);
                plantCount++;

                // ... Existing code ...

                document.getElementById("historyCount").textContent = "My Plants: " + plantCount;

                // Send the selected plant data to the server using AJAX
                $.ajax({
                    url: '/save_plant',
                    type: 'POST',
                    data: JSON.stringify(historyEntry),
                    contentType: 'application/json',
                    success: function (response) {
                        console.log("Plant data saved successfully!");
                    },
                    error: function (error) {
                        console.error("Error occurred while saving plant data:", error);
                    }
                });

            });

        });
    </script>
</body>

</html>